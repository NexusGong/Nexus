# 📚 项目文档索引

## 📋 文档概览

本项目包含完整的文档体系，涵盖开发记录、部署指南、变更日志等各个方面。

### 2025-11-27 更新要点（与代码保持一致）

- **卡片样式重构（游戏风格）**：
  - 完全重写卡片预览组件，采用抽卡游戏风格设计
  - 稀有度系统：根据分析结果自动判定（SSR/SR/R/N）
  - 3D卡片效果：透视、旋转、光效动画
  - 卡片生成动画：全屏抽卡动画、进度文字轮播
  - 视觉体验大幅提升，增加游戏感和仪式感
- **AI主动引导生成卡片**：
  - 所有角色Prompt更新，添加卡片引导逻辑
  - 当对话进行到一定程度（3-5轮交流）且AI已充分了解用户需求后，主动建议生成卡片
  - 引导语符合角色风格，自然不突兀
- **Prompt系统重构（参数化模板）**：
  - 使用通用模板 + 角色特定模板，减少重复代码
  - 确保每个角色风格符合人设
  - 统一引导逻辑，但表达方式个性化
- **AI回复质量提升**：
  - 回复长度：3-5句 → 5-8句
  - 更深入的分析，提供具体建议
  - 更强的角色特色，符合人设
  - AI参数优化：max_tokens 2000，temperature 0.8
- **数据库和删除逻辑修复**：
  - 修复analysis_cards表conversation_id约束问题，允许角色对话卡片不关联普通对话
  - 修复删除对话后仍停留在对话界面的问题
  - 删除后立即跳转到正确页面，状态完全清除
  - 详细功能说明请参考 [DAILY_SUMMARY_2025_11_27.md](./DAILY_SUMMARY_2025_11_27.md)

### 2025-11-22 更新要点（与代码保持一致）

- **角色解锁系统完整实现**：
  - 权限控制：未登录用户只能使用R角色，登录用户默认1个SSR+1个SR+所有R
  - 付费解锁：其他SSR和SR角色需要付费解锁（SSR 2.9元，SR 1.9元）
  - 模拟支付流程：3步支付体验（验证、处理、确认），可视化展示
  - 角色锁定状态：清晰的遮罩、图标和提示，不影响信息查看
  - 角色管理优化：与选择页面逻辑统一，显示解锁时间
  - 角色数据更新：删除4个角色，哆啦A梦调整为SR
  - 详细功能说明请参考 [DAILY_SUMMARY_2025_11_22.md](./DAILY_SUMMARY_2025_11_22.md)

### 2025-11-21 更新要点（与代码保持一致）

- **AI角色系统全面升级**：
  - 重新设计16个AI角色，全部聚焦沟通问题解决
  - 新增12个热门角色（五条悟、阿尼亚、炭治郎、约尔、安欣、高启强、范闲等）
  - 游戏化稀有度系统（SSR/SR/R/N）
  - 角色管理功能：用户角色拥有状态管理
  - 优化角色选择页面UI：紧凑布局，按稀有度排序
  - 修复空对话问题：延迟对话创建，避免无效数据
  - 详细功能说明请参考 [DAILY_SUMMARY_2025_11_21.md](./DAILY_SUMMARY_2025_11_21.md)

### 2025-11-07 更新要点（与代码保持一致）

- **卡片模式与自由交谈模式**：
  - 新增卡片模式：像抽卡游戏一样，输入内容后生成精美的分析卡片
  - 新增自由交谈模式：与16个有趣的AI角色进行多轮对话
  - 支持流式输出（SSE）和Markdown渲染
  - 采用豆包UI风格设计
  - 完整的角色管理和对话管理功能
  - 详细功能说明请参考 [FEATURE_PLAN_CARD_AND_CHAT_MODES.md](./FEATURE_PLAN_CARD_AND_CHAT_MODES.md)

### 2025-11-01 更新要点（与代码保持一致）

- **OCR提供方选择功能**：
  - 支持在图片预览界面选择识别提供方（豆包OCR / 火山引擎OCR）
  - 统一上传与调用流程，便于切换与后续扩展
- **简化OCR处理流程**：
  - 移除了流式输出功能，统一使用批量API
  - 简化了处理中的UI，移除复杂的进度显示
  - 简化了文本选择对话框的标题和描述
- **UI优化**：
  - 模式选择卡片设计优化，选中状态更清晰
  - 文本颜色对比度提高，确保清晰可读
  - 标签顺序调整，"已选择"标签显示在角色标签左侧

### 2025-10-31 更新要点（与代码保持一致）

- 主题切换：在 HTML 根元素应用 `dark`，切换瞬间添加 `theme-changing` 禁用过渡，确保所有元素一致切换速度。
- Toast 视口：移动至右下角，避免居中遮挡。
- 前端样式：将 `bg-white / text-gray-* / border-gray-*` 等硬编码类统一替换为主题令牌（`bg-background/bg-card/bg-muted`、`text-foreground/text-muted-foreground`、`border/border-input`）。
- 聊天 UI：助手/分析气泡统一为 `bg-muted text-foreground border`，用户气泡保留品牌蓝。
- 卡片列表：卡片容器使用 `bg-card border`，强调区块使用 `bg-primary/5`，移除浅色渐变。
- 导出接口修复：后端导出服务函数签名新增可选 `user_timezone`，与路由调用一致，修复 500。
- 空对话避免：未输入内容时不创建对话，选择模式仅记忆为 `pendingContextMode`，首条消息发送时才创建。

## 📁 文档结构

### 📖 主要文档
- **[README.md](../README.md)** - 项目主要文档，包含功能介绍、快速开始、技术栈等
- **[DOCUMENTATION_CHANGELOG.md](./DOCUMENTATION_CHANGELOG.md)** - 文档变更日志，记录所有重要更新

### 🚀 部署相关
- **[DEPLOYMENT.md](./DEPLOYMENT.md)** - 详细的部署指南，支持多种部署方式

### 📝 开发记录
- **[DAILY_SUMMARY_2025_11_27.md](./DAILY_SUMMARY_2025_11_27.md)** - 2025-11-27 每日总结：卡片样式重构、Prompt优化、删除逻辑修复
- **[DAILY_SUMMARY_2025_11_22.md](./DAILY_SUMMARY_2025_11_22.md)** - 2025年11月22日开发记录
- **[DAILY_SUMMARY_2025_11_21.md](./DAILY_SUMMARY_2025_11_21.md)** - 2025年11月21日开发记录
- **[DAILY_SUMMARY_2025_11_19.md](./DAILY_SUMMARY_2025_11_19.md)** - 2025年11月19日开发记录
- **[DAILY_SUMMARY_2025_11_07.md](./DAILY_SUMMARY_2025_11_07.md)** - 2025年11月07日开发记录
- **[DAILY_SUMMARY_2025_11_06.md](./DAILY_SUMMARY_2025_11_06.md)** - 2025年11月06日开发记录
- **[DAILY_SUMMARY_2025_11_05.md](./DAILY_SUMMARY_2025_11_05.md)** - 2025年11月05日开发记录
- **[DAILY_SUMMARY_2025_11_01.md](./DAILY_SUMMARY_2025_11_01.md)** - 2025年11月01日开发记录
- **[DAILY_SUMMARY_2025_10_31.md](./DAILY_SUMMARY_2025_10_31.md)** - 2025年10月31日开发记录
- **[DAILY_SUMMARY_2025_10_29.md](./DAILY_SUMMARY_2025_10_29.md)** - 2025年10月29日开发记录
- **[DAILY_SUMMARY_2025_10_28.md](./DAILY_SUMMARY_2025_10_28.md)** - 2025年10月28日开发记录
- **[DAILY_SUMMARY_2025_10_24.md](./DAILY_SUMMARY_2025_10_24.md)** - 2025年10月24日开发记录

### 🎯 功能文档
- **[FEATURE_PLAN_CARD_AND_CHAT_MODES.md](./FEATURE_PLAN_CARD_AND_CHAT_MODES.md)** - 卡片模式与自由交谈模式开发计划
- **[IMPLEMENTATION_STATUS.md](./IMPLEMENTATION_STATUS.md)** - 卡片模式与自由交谈模式实现状态

## 🎯 快速导航

### 新用户入门
1. 阅读 [README.md](../README.md) 了解项目概况
2. 查看 [DEPLOYMENT.md](./DEPLOYMENT.md) 进行环境配置
3. 运行 `./setup.sh` 一键设置环境

### 开发者参考
1. 查看 DOCUMENTATION_CHANGELOG.md 了解文档最新变更
2. 阅读开发记录了解功能实现细节（包括 2025-10-31 当日记录）
3. 参考部署指南进行生产环境配置

### 项目维护
1. 定期更新 DOCUMENTATION_CHANGELOG.md
2. 记录重要开发节点
3. 维护部署文档的准确性

## 📊 文档统计

- **总文档数**: 6个
- **总字数**: 约30,000字
- **覆盖内容**: 功能说明、技术实现、部署指南、开发记录
- **更新频率**: 每次重要更新都会更新相关文档

## 🔄 文档维护

### 更新原则
- 功能更新时同步更新README和变更日志
- 重要开发节点记录到开发记录
- 部署方式变更时更新部署指南
- 保持文档的准确性和时效性

### 维护责任
- 开发者负责更新技术文档
- 项目维护者负责更新变更日志
- 所有团队成员都有义务保持文档的准确性

## 📞 文档反馈

如果您发现文档中的问题或有改进建议，请：
1. 提交Issue反馈问题
2. 提交Pull Request改进文档
3. 联系项目维护者

---

**最后更新**: 2025年11月22日  
**维护者**: 项目开发团队  
**版本**: 1.3.0（角色解锁系统完整实现）


